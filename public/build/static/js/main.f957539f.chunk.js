(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{34:function(e,t,n){},62:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(35),s=n.n(c),i=n(9),o=n(3),d=n(4),l=n(6),h=n(5),u=n(36),p=n.n(u).a.create({baseURL:"https://pkmn-shop.herokuapp.com",withCredentials:!0});function j(e){if(e.response.data)throw console.log(e.response&&e.response.data),e;throw e}var b={service:p,signup:function(e){return p.post("/api/auth/signup",e).then((function(e){return e.data})).catch(j)},signin:function(e){return p.post("/api/auth/signin",e).then((function(e){return e.data})).catch(j)},logout:function(){return p.get("/api/auth/logout").then((function(e){return e.data})).catch(j)},isLoggedIn:function(){return p.get("/api/users/profile").then((function(e){return e.data})).catch(j)},getOneCard:function(e){return p.get("/api/me/cards/"+e).then((function(e){return e.data})).catch(j)},getItems:function(){return p.get("/api/pokemonApi/all").then((function(e){return e.data})).catch(j)},getOneCardFromApi:function(e){return p.get("/api/pokemonApi/".concat(e)).then((function(e){return e.data})).catch(j)},getApiByPage:function(e){return p.get("/api/pokemonApi/all/".concat(e)).then((function(e){return e.data})).catch(j)},filterApiByName:function(e,t){return p.get("/api/pokemonApi/search/".concat(e,"/").concat(t)).then((function(e){return e.data})).catch(j)},getAllUserCards:function(){return p.get("/api/me/cards").then((function(e){return e.data})).catch(j)},addCard:function(e){return p.post("/api/me/cards/add",e).then((function(e){return e.data})).catch(j)},updateCard:function(e,t){return p.patch("/api/me/cards/".concat(e,"/edit"),t).then((function(e){return e.data})).catch(j)},getUserCollection:function(e){return p.get("/api/me/collection/".concat(e)).then((function(e){return e.data})).catch(j)},getOneUserCard:function(e){return p.get("/api/me/cards/"+e).then((function(e){return e.data})).catch(j)},createBid:function(e){return p.post("/api/bids/create",e).then((function(e){return e.data})).catch(j)},deleteBid:function(e){return p.delete("/api/bids/".concat(e)).then((function(e){return e.data})).catch(j)},findCardsOnSale:function(){return p.get("/api/bids").then((function(e){return e.data})).catch(j)},findUserAuctions:function(){return p.get("/api/profile/auctions").then((function(e){return e.data})).catch(j)},findBid:function(e){return p.get("/api/bids/".concat(e)).then((function(e){return e.data})).catch(j)},updatedBids:function(e,t){return p.patch("/api/bids/".concat(e),t).then((function(e){return e.data})).catch(j)},getAllUserCardsFromApiCard:function(e){return p.get("/api/me/cards/all/"+e).then((function(e){return e.data})).catch(j)},getCardsOnSale:function(e){return p.get("/api/cards/bids/"+e).then((function(e){return e.data})).catch(j)},getAllCardsOpenForExchange:function(){return p.get("/api/exchanges").then((function(e){return e.data})).catch(j)},getAllCardsOneOfApiIdOpenForExchange:function(e){return p.get("/api/exchanges/"+e).then((function(e){return e.data})).catch(j)},createExchange:function(e){return p.post("/api//profile/exchanges/create",e).then((function(e){return e.data})).catch(j)},getUserCardsOpenForExchange:function(){return p.get("/api/profile/exchanges").then((function(e){return e.data})).catch(j)},deleteExchange:function(e){return p.delete("/api/profile/exchanges/".concat(e)).then((function(e){return e.data})).catch(j)}},O=a.a.createContext(),f=n(0),x=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={user:null,isLoggedIn:!1,isLoading:!0},e.setUser=function(t){e.setState({user:t,isLoggedIn:!0})},e.removeUser=function(){e.setState({user:null,isLoggedIn:!1})},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;b.isLoggedIn().then((function(t){e.setState({user:t,isLoggedIn:!0,isLoading:!1})})).catch((function(t){e.setState({user:null,isLoggedIn:!1,isLoading:!1})}))}},{key:"render",value:function(){var e={user:this.state.user,setUser:this.setUser,removeUser:this.removeUser,isLoggedIn:this.state.isLoggedIn,isLoading:this.state.isLoading};return Object(f.jsx)(O.Provider,{value:e,children:this.props.children})}}]),n}(r.Component),m=n(10),g=n(8),v=function(e){return function(t){return Object(f.jsx)(O.Consumer,{children:function(n){return Object(f.jsx)(e,Object(g.a)(Object(g.a)({},t),{},{context:n}))}})}},k=(n(62),v((function(e){var t=e.context;return Object(f.jsxs)("nav",{className:"NavMain",children:[Object(f.jsx)(i.c,{exact:!0,to:"/",children:Object(f.jsx)("h3",{className:"logo",children:"App name"})}),Object(f.jsxs)("ul",{className:"nav-list",children:[t.isLoggedIn&&Object(f.jsxs)(a.a.Fragment,{children:[Object(f.jsx)("li",{children:Object(f.jsx)(i.c,{to:"/profile/cards",children:"User Cards"})}),Object(f.jsx)("li",{children:Object(f.jsx)(i.c,{to:"/profile/auctions",children:"Auctions"})}),Object(f.jsx)("li",{children:Object(f.jsx)(i.c,{to:"/profile/exchanges",children:"User Exchanges"})}),Object(f.jsx)("li",{children:Object(f.jsx)(i.c,{to:"/profile",children:t.user&&t.user.email})}),Object(f.jsx)("li",{children:Object(f.jsx)("p",{onClick:function(){b.logout().then((function(){t.removeUser()})).catch((function(e){console.log(e)}))},children:"Logout"})})]}),!t.isLoggedIn&&Object(f.jsxs)(a.a.Fragment,{children:[Object(f.jsx)("li",{children:Object(f.jsx)(i.c,{to:"/signin",children:"Log in"})}),Object(f.jsx)("li",{children:Object(f.jsx)(i.c,{to:"/signup",children:"Create account"})})]})]})]})}))),C=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(f.jsxs)("div",{children:[Object(f.jsx)("h1",{children:"Home"}),Object(f.jsx)("p",{children:Object(f.jsx)(i.b,{to:"/cards",children:"See all cards"})})]})}}]),n}(a.a.Component),y=n(16),w=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={email:"",password:""},e.handleChange=function(t){var n=t.target.name,r=t.target.value;e.setState(Object(y.a)({},n,r))},e.handleSubmit=function(t){t.preventDefault(),b.signin(e.state).then((function(t){e.props.context.setUser(t)})).catch((function(e){console.log(e)}))},e}return Object(d.a)(n,[{key:"render",value:function(){return this.props.context.user?Object(f.jsx)(m.a,{to:"/"}):Object(f.jsxs)("form",{onChange:this.handleChange,onSubmit:this.handleSubmit,children:[Object(f.jsx)("h2",{children:"Signin"}),Object(f.jsx)("label",{htmlFor:"email",children:"Email"}),Object(f.jsx)("input",{type:"email",id:"email",name:"email"}),Object(f.jsx)("label",{htmlFor:"password",children:"Password"}),Object(f.jsx)("input",{type:"password",id:"password",name:"password"}),Object(f.jsx)("button",{children:"Submit"})]})}}]),n}(r.Component),S=Object(m.g)(v(w)),I=function(e){return Object(f.jsx)(S,{})},A=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={email:"",password:"",username:""},e.handleChange=function(t){var n=t.target.value,r=t.target.name;e.setState(Object(y.a)({},r,n))},e.handleSubmit=function(t){t.preventDefault(),b.signup(e.state).then((function(){e.props.history.push("/signin")})).catch((function(e){console.log(e)}))},e}return Object(d.a)(n,[{key:"render",value:function(){return this.props.context.user?Object(f.jsx)(m.a,{to:"/"}):Object(f.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(f.jsx)("h2",{children:"Signup"}),Object(f.jsx)("label",{htmlFor:"username",children:"Username"}),Object(f.jsx)("input",{onChange:this.handleChange,value:this.state.username,type:"username",id:"username",name:"username"}),Object(f.jsx)("label",{htmlFor:"email",children:"Email"}),Object(f.jsx)("input",{onChange:this.handleChange,value:this.state.email,type:"email",id:"email",name:"email"}),Object(f.jsx)("label",{htmlFor:"password",children:"Password"}),Object(f.jsx)("input",{onChange:this.handleChange,value:this.state.password,type:"password",id:"password",name:"password"}),Object(f.jsx)("button",{children:"Submit"})]})}}]),n}(r.Component),F=Object(m.g)(v(A)),N=function(e){return Object(f.jsx)(F,{})},P=n(38),B=["component","context"],L=v((function(e){var t=e.component,n=e.context,r=Object(P.a)(e,B);return n.isLoading?null:n.isLoggedIn?Object(f.jsx)(m.b,Object(g.a)(Object(g.a)({},r),{},{render:function(e){return Object(f.jsx)(t,Object(g.a)({},e))}})):Object(f.jsx)(m.a,{to:"/signin"})})),D=function(e){return Object(f.jsx)("div",{children:Object(f.jsx)("h1",{children:"Protected profile"})})},T=n(2),E=n.n(T),G=n(7),_=n(18),U=(n(69),function(e){return Object(f.jsxs)("div",{className:"cardDiv",children:[Object(f.jsx)("img",{src:e.card.images.small,alt:"",height:"400px",width:"350px"}),Object(f.jsx)("div",{children:e.card.name}),e.children]},e.key)}),M=n(20),R=function(e){return Object(f.jsxs)("div",{className:"FormField",children:[Object(f.jsx)("label",{htmlFor:e.htmlFor,children:e.label}),e.children]})},Y=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).handleNameInputChange=r.handleNameInputChange.bind(Object(M.a)(r)),r}return Object(d.a)(n,[{key:"handleNameInputChange",value:function(e){this.props.handleNameInputChange(e.target.value)}},{key:"render",value:function(){return Object(f.jsx)("div",{className:"SearchBar",children:Object(f.jsxs)("form",{onSubmit:this.props.onSubmit,children:[Object(f.jsx)(R,{children:Object(f.jsx)("input",{type:"text",value:this.props.name,onChange:this.handleNameInputChange,name:"name"})}),Object(f.jsx)("button",{type:"submit",children:"Search"})]})})}}]),n}(r.Component),H=function(){return Object(f.jsx)("div",{children:Object(f.jsx)("p",{children:"Wait a bit... we need to catch 'em all ! "})})},W=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={cards:[],loadingPage:!1,page:1,prevY:0,name:""},e.getPokemonsByName=function(t,n){e.setState({loading:!0}),b.filterApiByName(t,n).then((function(t){e.setState({cards:[].concat(Object(_.a)(e.state.cards),Object(_.a)(t.data)),loadingPage:!0})})).catch((function(e){return console.log(e)}))},e.handleNameInputChange=function(t){e.setState({name:t})},e.addCard=function(){var e=Object(G.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.addCard({pokemonTCGId:t});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),e}return Object(d.a)(n,[{key:"getAllPokemons",value:function(e){var t=this;this.setState({loading:!0}),b.getApiByPage(e).then((function(e){t.setState({cards:[].concat(Object(_.a)(t.state.cards),Object(_.a)(e.data))}),t.setState({loading:!1})})).catch((function(e){console.log(e)}))}},{key:"handleObserverAll",value:function(e,t){var n=e[0].boundingClientRect.y;if(this.state.prevY>n){var r=this.state.page+1;this.getAllPokemons(r),this.setState({page:r})}this.setState({prevY:n})}},{key:"handleObserverName",value:function(e,t){var n=e[0].boundingClientRect.y;if(this.state.prevY>n){var r=this.state.page+1;this.getPokemonsByName(this.state.name,r),this.setState({page:r})}this.setState({prevY:n})}},{key:"componentDidMount",value:function(){this.getAllPokemons(this.state.page);this.observer=new IntersectionObserver(this.handleObserverAll.bind(this),{root:null,rootMargin:"0px",threshold:1}),this.observer.observe(this.loadingRef)}},{key:"componentDidUpdate",value:function(){var e=Object(G.a)(E.a.mark((function e(t,n){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.name!==n.name&&(this.getPokemonsByName(this.state.name,this.state.page),console.log(this.state.cards),r={root:null,rootMargin:"0px",threshold:1},this.observer=new IntersectionObserver(this.handleObserverName.bind(this),r),this.observer.observe(this.loadingRef)),this.state.name!==n.name&&""===this.state.name&&this.getAllPokemons(this.state.page);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t={display:this.state.loading?"block":"none"};return Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("h1",{children:"Hello"}),Object(f.jsx)(Y,{name:this.state.name,handleNameInputChange:this.handleNameInputChange}),this.state.loadingPage&&Object(f.jsx)(H,{}),Object(f.jsx)("div",{style:{minHeight:"800px",display:"flex",flexWrap:"wrap"},children:this.state.cards.map((function(t){return Object(f.jsx)(U,{card:t,children:Object(f.jsxs)("div",{children:[Object(f.jsx)(i.b,{to:"/cards/"+t.id,children:"Card details"}),Object(f.jsx)("button",{onClick:function(){e.addCard(t.id)},children:"Add Card"})]})})}))}),Object(f.jsx)("div",{ref:function(t){return e.loadingRef=t},style:{height:"100px",margin:"30px"},children:this.state.cards.length>0&&Object(f.jsx)(H,{style:t})})]})}}]),n}(r.Component),J=(r.Component,n(70),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={currentBid:0,bidId:"",previousBid:e.props.offer.bid.currentBid,bid:{}},e.handleChange=function(t){var n=t.target.name,r=t.target.value;e.setState(Object(y.a)({},n,r))},e.handleSubmit=function(t){if(e.state.currentBid<e.state.previousBid)console.log("current bid is too low");else{var n={currentBid:e.state.currentBid};b.updatedBids(t,n),e.setState({bid:n})}},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.findBid(this.props.offer.bid._id);case 2:t=e.sent,this.setState({bid:t}),console.log("Bid called in oneOffer ",this.state.bid);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:this.props.offer.owner.email}),Object(f.jsx)("td",{children:this.props.offer.cardState}),Object(f.jsxs)("td",{children:[this.props.offer.bid.initialPrice," $"]}),Object(f.jsx)("td",{children:this.state.bid.currentBid?"".concat(this.state.bid.currentBid," $"):"Be the first to Bid"}),Object(f.jsx)("td",{children:this.props.offer.bid.endDate}),Object(f.jsx)("td",{children:Object(f.jsx)("input",{type:"number",name:"currentBid",value:this.state.currentBid,onChange:this.handleChange})}),Object(f.jsx)("td",{children:Object(f.jsx)("button",{onClick:function(){return e.handleSubmit(e.state.bid._id)},children:"Place Bid"})})]},this.state.bid._id)}}]),n}(r.Component)),$=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return console.log(this.props.offers),Object(f.jsx)("div",{children:Object(f.jsxs)("table",{children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:"Seller"}),Object(f.jsx)("td",{children:"Card State"}),Object(f.jsx)("td",{children:"Initial Price"}),Object(f.jsx)("td",{children:"Current Bid"}),Object(f.jsx)("td",{children:"End date"}),Object(f.jsx)("td",{children:"Your offer"}),Object(f.jsx)("td",{children:"Confirm"})]})}),Object(f.jsx)("tbody",{children:this.props.offers.map((function(e){return Object(f.jsx)(J,{offer:e})}))})]})})}}]),n}(r.Component),z=(n(34),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(f.jsxs)("div",{className:"info-container",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{className:"pokemon-name",children:this.props.pokemon.name}),Object(f.jsxs)("div",{className:"pokemon-type",children:[Object(f.jsxs)("h3",{children:[this.props.pokemon.subtypes[0]," ",this.props.pokemon.supertype]}),Object(f.jsxs)("p",{children:["HP",this.props.pokemon.hp,"/"]})]})]}),this.props.abilities&&Object(f.jsxs)("div",{className:"abilities",children:[Object(f.jsx)("h3",{children:this.props.pokemon.abilities.type}),Object(f.jsx)("p",{children:this.props.pokemon.abilities.name}),Object(f.jsx)("p",{children:this.props.pokemon.abilities.text})]}),Object(f.jsxs)("div",{className:"attacks",children:[Object(f.jsxs)("p",{children:[this.props.pokemon.attacks.name," ",Object(f.jsx)("span",{children:this.props.pokemon.attacks.damage})]}),Object(f.jsx)("p",{children:this.props.pokemon.attacks.text})]}),Object(f.jsxs)("div",{className:"pokemon-div-3",children:[Object(f.jsxs)("div",{className:"w-r-rc",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Weakness"}),this.props.pokemon.weaknesses&&Object(f.jsxs)("p",{children:[this.props.pokemon.weaknesses.type," x ",this.props.pokemon.weaknesses.value]})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Resistance"}),this.props.pokemon.resistances&&Object(f.jsxs)("p",{children:[this.props.pokemon.resistances.type," ",Object(f.jsx)("span",{children:this.props.pokemon.resistances.value})]})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Retreat Cost"}),this.props.pokemon.retreatCost&&Object(f.jsxs)("p",{children:[this.props.pokemon.retreatCost[0]," x ",this.props.pokemon.convertedRetreatCost]})]})]}),Object(f.jsxs)("div",{className:"set",children:[Object(f.jsxs)("div",{children:[Object(f.jsxs)("p",{children:[this.props.pokemon.supertype.series," \u2013 ",this.props.pokemon.name]}),Object(f.jsxs)("p",{children:[this.props.pokemon.number,"/",this.props.pokemon.set.total," ",this.props.pokemon.rarity]})]}),Object(f.jsx)("img",{src:this.props.pokemon.set.images.symbol,alt:"symbol set"})]})]}),Object(f.jsx)("div",{children:Object(f.jsxs)("p",{children:["Illustrator : ",this.props.pokemon.artist]})})]})}}]),n}(r.Component)),q=function(e){return Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)("img",{src:e.pokemon.images.large,alt:"card"}),Object(f.jsx)(z,{pokemon:e.pokemon})]})},K=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).handleChange=function(t){e.props.handleChange(t)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Select card(s)"}),this.props.cards.map((function(t){return Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{type:"checkbox",id:t._id,onChange:e.props.handleChange}),Object(f.jsxs)("label",{htmlFor:"items",children:[t.pokemonTCGId.name," \u2013 ",t._id]})]},t._id)}))]})}}]),n}(r.Component),Q=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={loading:!0,cards:[],exchangeItems:[]},e.addCard=function(t){var n=e.state.exchangeItems;n.push(t),e.setState({exchangeItems:n})},e.deleteCard=function(t){var n=Object(_.a)(e.state.exchangeItems).filter((function(e){return e!==t}));e.setState({exchangeItems:n})},e.handleChange=function(t){t.target.checked?e.addCard(t.target.id):e.deleteCard(t.target.id)},e.handleSubmit=Object(G.a)(E.a.mark((function t(){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={seller:e.props.offer.owner._id,sellerItem:e.props.offer._id,buyerItem:e.state.exchangeItems},t.prev=1,t.next=4,b.createExchange(n);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.error(t.t0);case 9:case"end":return t.stop()}}),t,null,[[1,6]])}))),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getAllUserCards();case 2:return t=e.sent,n=t.map((function(e){return b.getOneCardFromApi(e.pokemonTCGId)})),e.next=6,Promise.all(n);case 6:r=e.sent,a=t.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{pokemonTCGId:r[t]})})),this.setState({cards:a,loading:!1});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:this.props.offer.owner.email}),Object(f.jsx)("td",{children:this.props.offer.cardState}),Object(f.jsx)("td",{children:this.props.pokemon.cardmarket.prices.averageSellPrice}),Object(f.jsx)("td",{children:Object(f.jsxs)("div",{children:[this.state.loading&&Object(f.jsx)("div",{children:Object(f.jsx)("p",{children:"Catching all your pokemons... plz hooold"})}),!this.state.loading&&Object(f.jsx)(K,{cards:this.state.cards,exchangeItems:this.state.exchangeItems,handleChange:this.handleChange})]})}),Object(f.jsx)("td",{children:Object(f.jsx)("ul",{children:this.state.exchangeItems.map((function(e){return Object(f.jsx)("li",{children:e})}))})}),Object(f.jsx)("td",{children:Object(f.jsx)("button",{onClick:this.handleSubmit,children:"Confirm offer"})})]},this.props.offer._id)}}]),n}(r.Component),V=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this;return Object(f.jsxs)("div",{children:[Object(f.jsx)("h3",{children:"All listings open for exchange"}),Object(f.jsxs)("table",{children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:"Owner"}),Object(f.jsx)("td",{children:"Card state"}),Object(f.jsx)("td",{children:"Average Sell Price"}),Object(f.jsx)("td",{children:"What do you wanna exchange ?"}),Object(f.jsx)("td",{children:"Your current offer"}),Object(f.jsx)("td",{children:"Confirm offer"})]})}),Object(f.jsx)("tbody",{children:this.props.offers.map((function(t){return Object(f.jsx)(Q,{offer:t,pokemon:e.props.pokemon})}))})]})]})}}]),n}(r.Component),X=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={user:{},pokemon:null,isLoggedIn:!1,userCards:[],formDisplayed:!1,cardsOnSale:[],cardsOpenForExchange:[]},e.addCard=Object(G.a)(E.a.mark((function t(){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.addCard({pokemonTCGId:e.props.match.params.id});case 3:return t.next=5,b.getAllUserCardsFromApiCard(e.state.pokemon.id);case 5:n=t.sent,e.setState({userCards:n}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])}))),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r,a,c=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.isLoggedIn().then((function(e){c.setState({user:e,isLoggedIn:!0})})).catch((function(e){c.setState({user:null,isLoggedIn:!1})}));case 3:return e.next=5,b.getOneCardFromApi(this.props.match.params.id);case 5:return t=e.sent,this.setState({pokemon:t}),e.next=9,b.getAllUserCardsFromApiCard(this.state.pokemon.id);case 9:return n=e.sent,this.setState({userCards:n}),e.next=13,b.getCardsOnSale(this.state.pokemon.id);case 13:return r=e.sent,this.setState({cardsOnSale:r}),e.next=17,b.getAllCardsOneOfApiIdOpenForExchange(this.state.pokemon.id);case 17:a=e.sent,this.setState({cardsOpenForExchange:a}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.error(e.t0);case 24:case"end":return e.stop()}}),e,this,[[0,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return null===this.state.pokemon?Object(f.jsx)("div",{children:"Loading..."}):Object(f.jsxs)("div",{className:"OneCard",children:[Object(f.jsx)(q,{pokemon:this.state.pokemon}),Object(f.jsxs)("div",{children:[this.state.cardsOnSale.length>0?Object(f.jsx)($,{offers:this.state.cardsOnSale}):Object(f.jsx)("div",{children:"No vendor is currently selling this card."}),this.state.cardsOpenForExchange.length>0?Object(f.jsx)(V,{offers:this.state.cardsOpenForExchange,pokemon:this.state.pokemon}):Object(f.jsx)("div",{children:"No card is open for exchange for now."})]})]})}}]),n}(r.Component),Z=function(e){return Object(f.jsxs)("div",{className:"cardDiv",children:[Object(f.jsx)(U,{card:e.card.pokemonTCGId,link:"/profile/cards/"+e.card._id}),Object(f.jsxs)("div",{children:[Object(f.jsxs)("p",{children:["Average price: ",e.card.pokemonTCGId.cardmarket.prices.averageSellPrice]}),Object(f.jsx)(i.b,{to:"/cards/"+e.card._id,children:"Bid Details"})]})]},e.card._id)},ee=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={cards:[]},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.findCardsOnSale();case 2:return t=e.sent,n=t.map((function(e){return b.getOneCardFromApi(e.pokemonTCGId)})),e.next=6,Promise.all(n);case 6:r=e.sent,a=t.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{pokemonTCGId:r[t]})})),this.setState({cards:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(f.jsxs)("div",{children:[Object(f.jsx)("h1",{children:"ALL THE CARDS ON SALE"}),Object(f.jsx)("div",{children:this.state.cards.map((function(e){return Object(f.jsx)(Z,{card:e})}))})]})}}]),n}(r.Component),te=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={user:{},card:null,isLoggedIn:!1,initialPrice:0,endDate:"",cardState:""},e.handleChange=function(t){e.setState(Object(y.a)({},t.target.name,t.target.value))},e.createBid=function(){var t=Object(G.a)(E.a.mark((function t(n){var r,a;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r={item:e.props.card._id,initialPrice:e.state.initialPrice,startDate:Date.now(),endDate:e.state.endDate,status:"ongoing"},t.next=4,b.createBid(r);case 4:return a=t.sent,console.log(a),t.next=8,b.updateCard(e.props.card._id,{onSale:!0,price:e.state.initialPrice,bid:a._id,cardState:e.state.cardState});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.isLoggedIn().then((function(e){n.setState({user:e,isLoggedIn:!0})})).catch((function(e){n.setState({user:null,isLoggedIn:!1})}));case 3:return e.next=5,b.getOneCard(this.props.card._id);case 5:t=e.sent,this.setState({card:t}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return null===this.state.pokemon?Object(f.jsx)("div",{children:"Loading..."}):Object(f.jsx)("div",{className:"OneCard",children:Object(f.jsx)("div",{className:"container",children:Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"SaleForm"}),Object(f.jsx)(R,{label:"Select the state of the card you're selling",htmlFor:"cardState",children:Object(f.jsxs)("select",{name:"cardState",onChange:this.handleChange,children:[Object(f.jsx)("option",{disabled:!0,children:"Select"}),Object(f.jsx)("option",{value:"Mint",children:"Mint"}),Object(f.jsx)("option",{value:"Near Mint",children:"Near Mint"}),Object(f.jsx)("option",{value:"Bad",children:"Bad"})]})}),Object(f.jsxs)("p",{children:["Initial Price : ",this.props.card.pokemonTCGId.cardmarket.prices.averageSellPrice]}),Object(f.jsx)(R,{label:"Choose a price",htmlFor:"initialPrice",children:Object(f.jsx)("input",{type:"number",onChange:this.handleChange,value:this.state.initialPrice,name:"initialPrice"})}),Object(f.jsx)(R,{label:"end of the bid",htmlFor:"endDate",children:Object(f.jsx)("input",{type:"datetime-local",onChange:this.handleChange,value:this.state.endTime,name:"endDate"})}),Object(f.jsx)("button",{onClick:this.createBid,children:"Sell"})]})})})}}]),n}(r.Component),ne=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={openForExchange:e.props.card.openForExchange},e.handleClick=Object(G.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.updateCard(e.props.card._id,{openForExchange:!e.props.card.openForExchange});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])}))),e}return Object(d.a)(n,[{key:"render",value:function(){return Object(f.jsxs)("div",{children:[!this.props.card.openForExchange&&Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Not open for exchanges"}),Object(f.jsx)("button",{onClick:this.handleClick,children:"Accept exchanges"})]}),this.props.card.openForExchange&&Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Open for exchanges"}),Object(f.jsx)("button",{onClick:this.handleClick,children:"Refuse exchange"})]})]})}}]),n}(r.Component),re=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={cards:null,searchName:""},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getAllUserCards();case 2:return t=e.sent,n=t.map((function(e){return b.getOneCardFromApi(e.pokemonTCGId)})),e.next=6,Promise.all(n);case 6:r=e.sent,a=t.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{pokemonTCGId:r[t]})})),this.setState({cards:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return null===this.state.cards?Object(f.jsx)("div",{children:"Loading..."}):Object(f.jsxs)("div",{className:"CardsList",children:[Object(f.jsx)("h2",{children:"ALL USER'S CARDS"}),this.state.cards.map((function(e){return Object(f.jsxs)("div",{children:[Object(f.jsxs)(U,{card:e.pokemonTCGId,link:"/profile/cards/"+e._id,children:[Object(f.jsx)("button",{children:"Sell"}),Object(f.jsx)(ne,{card:e})]}),Object(f.jsx)(te,{card:e})]},e._id)}))]})}}]),n}(r.Component),ae=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).handleAccept=Object(G.a)(E.a.mark((function t(){var n,r;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.auction.item,r={owner:e.props.auction.buyer,onSale:!1,price:null},t.next=4,b.updateCard(n._id,r);case 4:return t.next=6,b.deleteBid(e.props.auction._id);case 6:console.log("bid finished");case 7:case"end":return t.stop()}}),t)}))),e.handleDelete=Object(G.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.deleteBid(e.props.auction._id);case 2:console.log("bid deleted");case 3:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(n,[{key:"render",value:function(){return console.log(this.props),Object(f.jsxs)("div",{children:[Object(f.jsx)(U,{card:this.props.auction.pokemonTCGId}),Object(f.jsxs)("div",{children:["Current Offer : ",this.props.auction.currentBid]}),Object(f.jsx)("button",{onClick:this.handleAccept,children:"Accept the offer"}),Object(f.jsx)("button",{onClick:this.handleDelete,children:"Remove card from sale"})]},this.props.auction._id)}}]),n}(r.Component),ce=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={auctions:[]},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.findUserAuctions();case 2:return t=e.sent,n=t.map((function(e){return b.getOneCardFromApi(e.item.pokemonTCGId)})),e.next=6,Promise.all(n);case 6:r=e.sent,a=t.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{pokemonTCGId:r[t]})})),this.setState({auctions:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(f.jsxs)("div",{children:[Object(f.jsx)("h1",{children:"User Auctions"}),Object(f.jsx)("div",{children:this.state.auctions.map((function(e){return Object(f.jsx)(ae,{auction:e})}))})]})}}]),n}(r.Component),se=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={cards:null},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getAllCardsOpenForExchange();case 2:return t=e.sent,n=t.map((function(e){return b.getOneCardFromApi(e.pokemonTCGId)})),e.next=6,Promise.all(n);case 6:r=e.sent,a=t.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{pokemonTCGId:r[t]})})),this.setState({cards:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return console.log(this.state.cards),null===this.state.cards?Object(f.jsx)("div",{children:"Loading..."}):Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Cards open for exchanges"}),this.state.cards.map((function(e){return Object(f.jsx)(U,{card:e.pokemonTCGId,children:Object(f.jsx)(i.b,{to:"/cards/"+e.pokemonTCGId.id,children:"Card details"})},e._id)}))]})}}]),n}(r.Component),ie=function(e){return Object(f.jsx)("div",{children:e.children})},oe=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={loading:!0,items:null},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props.items.map((function(e){return b.getOneCardFromApi(e.pokemonTCGId)})),e.next=4,Promise.all(t);case 4:n=e.sent,r=this.props.items.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{pokemonTCGId:n[t]})})),this.setState({items:r,loading:!1}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return!0===this.state.loading?Object(f.jsx)(H,{}):Object(f.jsx)("div",{children:Object(f.jsx)("ul",{children:this.state.items.map((function(e){return Object(f.jsx)("li",{children:Object(f.jsxs)("div",{children:[Object(f.jsx)("img",{src:e.pokemonTCGId.images.small,alt:"photo "+e.pokemonTCGId.name}),Object(f.jsx)("p",{children:e.pokemonTCGId.name}),Object(f.jsxs)("p",{children:["Average sell price : ",e.pokemonTCGId.cardmarket.prices.averageSellPrice]})]})},e._id+3)}))})})}}]),n}(r.Component),de=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).handleAccept=Object(G.a)(E.a.mark((function t(){var n,r,a;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={owner:e.props.exchange.buyer,openForExchange:!1},t.next=4,b.updateCard(e.props.exchange.sellerItem._id,n);case 4:return r={owner:e.props.exchange.seller,openForExchange:!1},a=e.props.exchange.buyerItem.map((function(e){return b.updateCard(e._id,r)})),t.next=8,Promise.all(a);case 8:return t.next=10,b.deleteExchange(e.props.exchange._id);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])}))),e.handleDecline=Object(G.a)(E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.deleteExchange(e.props.exchange._id);case 2:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(n,[{key:"render",value:function(){return console.log(this.props.exchange),Object(f.jsxs)("div",{children:[Object(f.jsx)(U,{card:this.props.exchange.pokemonTCGId}),Object(f.jsx)("div",{children:Object(f.jsxs)("p",{children:["Initial price of my card : ",this.props.exchange.pokemonTCGId.cardmarket.prices.averageSellPrice]})}),Object(f.jsx)(oe,{items:this.props.exchange.buyerItem}),Object(f.jsxs)("div",{children:[Object(f.jsx)("button",{onClick:this.handleAccept,children:"Accept Offer"}),Object(f.jsx)("button",{onClick:this.handleDecline,children:"Decline Offer"})]})]},this.props.exchange.sellerItem._id+1)}}]),n}(a.a.Component),le=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={exchanges:null,loading:!0},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=Object(G.a)(E.a.mark((function e(){var t,n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.getUserCardsOpenForExchange();case 3:return t=e.sent,n=t.map((function(e){return b.getOneCardFromApi(e.sellerItem.pokemonTCGId)})),e.next=7,Promise.all(n);case 7:r=e.sent,a=t.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{pokemonTCGId:r[t]})})),this.setState({exchanges:a,loading:!1}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.loading?Object(f.jsx)(H,{}):0===this.state.exchanges.length?Object(f.jsx)(ie,{children:"You don't have offers for exchanges yet..."}):Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Offers for exchange"}),this.state.exchanges.map((function(e){return Object(f.jsx)(de,{exchange:e})}))]})}}]),n}(r.Component);var he=function(){return Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)(k,{}),Object(f.jsxs)(m.d,{children:[Object(f.jsx)(m.b,{exact:!0,path:"/",component:C}),Object(f.jsx)(m.b,{exact:!0,path:"/signin",component:I}),Object(f.jsx)(m.b,{exact:!0,path:"/signup",component:N}),Object(f.jsx)(m.b,{exact:!0,path:"/cards",component:W}),Object(f.jsx)(m.b,{exact:!0,path:"/cards/:id",component:X}),Object(f.jsx)(m.b,{exact:!0,path:"/auctions",component:ee}),Object(f.jsx)(m.b,{exact:!0,path:"/exchanges",component:se}),Object(f.jsx)(L,{exact:!0,path:"/profile",component:D}),Object(f.jsx)(L,{path:"/profile/cards",component:re}),Object(f.jsx)(L,{exact:!0,path:"/profile/cards/:id",component:te}),Object(f.jsx)(L,{path:"/profile/auctions",component:ce}),Object(f.jsx)(L,{path:"/profile/exchanges",component:le})]})]})};n(71),n(72);s.a.render(Object(f.jsx)(i.a,{children:Object(f.jsx)(x,{children:Object(f.jsx)(he,{})})}),document.getElementById("root"))}},[[73,1,2]]]);
//# sourceMappingURL=main.f957539f.chunk.js.map